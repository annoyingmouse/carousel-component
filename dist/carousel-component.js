!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e),i.d(e,"CarouselComponent",(function(){return o}));class s{static createElement(t){return document.createElement(t)}static setText(t,e){return t.appendChild(document.createTextNode(e))}static createAndPopulate(t,e=null,i=null,n=null){const r=this.createElement(t);return e&&s.setText(r,e),i&&s.setAttributes(r,i),n&&s.setStyles(r,n),r}static setAttributes(t,e){for(const i in e)if(e.hasOwnProperty(i)){const s=i.split(/(?=[A-Z])/).join("-").toLowerCase();t.setAttribute(s,e[i])}}static setStyles(t,e){for(const i in e)if(e.hasOwnProperty(i)){const s=i.split(/(?=[A-Z])/).join("-").toLowerCase();t.style[s]=e[i]}}}class n{constructor(t,e,i){this.icon=t,this.name=e,this.parent=i,this.element}setDisabled(t){t?(s.setAttributes(this.element,{class:"disabled"}),s.setStyles(this.element,{cursor:"not-allowed",opacity:"0.7"})):(this.element.classList.remove("disabled"),s.setStyles(this.element,{cursor:"pointer",opacity:""}))}render(){this.element=s.createAndPopulate("div",this.icon,{alt:"prev"===this.name?"Previous item":"next"===this.name?"Next item":"play"===this.name?"Start auto scrolling":"Stop auto scrolling",title:"prev"===this.name?"Scroll back to previous item":"next"===this.name?"Scroll forward to next item":"play"===this.name?"Start automatic scrolling":"Stop automatic scrolling",class:this.name},{position:"absolute",fontSize:"3em",cursor:"pointer"}),"prev"===this.name&&s.setStyles(this.element,{top:"50%",transform:"translateY(-50%)",left:0}),"next"===this.name&&s.setStyles(this.element,{top:"50%",transform:"translateY(-50%)",right:0}),"play"===this.name&&s.setStyles(this.element,{left:"50%",transform:"translateX(-50%)",top:0}),"stop"===this.name&&s.setStyles(this.element,{left:"50%",transform:"translateX(-50%)",top:0,display:"none"}),this.parent.element.appendChild(this.element),"prev"!==this.name&&"next"!==this.name||this.element.addEventListener("click",function(){this.element.classList.contains("disabled")||(this.parent.disableNav(),this.parent.sendDirection(this.name))}.bind(this)),"play"===this.name&&this.element.addEventListener("click",function(){this.parent.play()}.bind(this)),"stop"===this.name&&this.element.addEventListener("click",function(){this.parent.stop()}.bind(this))}show(){s.setStyles(this.element,{display:"unset"})}hide(){s.setStyles(this.element,{display:"none"})}}class r{constructor(t,e,i,s,n,r){this.id=t,this.productUrl=e,this.imageSrc=i,this.productTitle=s,this.price=this.formatter(n),this.width=r,this.element=this.generate()}formatter(t){return new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP"}).format(t)}generate(){const t=s.createAndPopulate("a",null,{class:"carousel_item",dataId:this.id,href:this.productUrl,target:"_blank",style:`width:${this.width}px; height: 100%`},{float:"left",display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"center",textDecoration:"none"});t.appendChild(s.createAndPopulate("img",null,{src:this.imageSrc,alt:this.productTitle,onerror:"this.onerror=null;this.src='./img/logo.svg';"},{height:"60%",maxWidth:"100%"}));const e=s.createAndPopulate("div",null,{class:"details"},{height:"30%",textAlign:"center",display:"flex",flexDirection:"column",justifyContent:"space-between",fontFamily:"Arial, Helvetica, sans-serif",color:"darkgrey"});t.appendChild(e);const i=s.createAndPopulate("h2",this.productTitle,null,{margin:"0",fontWeight:"100",fontSize:1.5/350*this.width+"em"});e.appendChild(i);const n=s.createAndPopulate("p",this.price,null,{fontSize:1/350*this.width+"em"});return e.appendChild(n),t}resize(t){s.setStyles(this.element,{width:t+"px"}),s.setStyles(this.element.querySelector("h2"),{fontSize:1.5/350*t+"em"}),s.setStyles(this.element.querySelector("p"),{fontSize:1/350*t+"em"})}}class a{constructor(t,e,i=500){this.third=t,this.parent=e,this.transition=i,this.element=s.createAndPopulate("div",null,{class:"carousel_track"},{height:"100%",transition:`transform ${i}ms ease 0s`,transform:`translateX(${-Math.abs(6*t)}px)`}),this.current=this.data,this.min=null,this.max=null,this.children=[]}addData(t){this.data=[...t.slice(-3),...t,...t.slice(0,3)],this.element.style.width=this.data.length*this.third+"px",this.max=-Math.abs((this.data.length-3)*this.third),this.current=-Math.abs(6*this.third),this.min=-Math.abs(3*this.third),this.data.forEach(t=>{const e=new r(t.id,t.productUrl,t.imageSrc,t.productTitle,t.price,this.third);this.element.appendChild(e.element),this.children.push(e)})}scroll(t){this.current="prev"===t?this.current+this.third:this.current-this.third,this.element.style.transform=`translateX(${this.current}px)`,setTimeout(function(){this.current>this.min-10||this.current<this.max+10?(this.element.style.transition="none",this.current=this.current>this.min-10?this.max:this.min,this.element.style.transform=`translateX(${this.current}px)`,setTimeout(function(){this.element.style.transition=`transform ${this.transition}ms ease 0s`,this.parent.enableNav()}.bind(this),this.transition/10)):this.parent.enableNav()}.bind(this),this.transition)}resize(t){s.setStyles(this.element,{transition:"none"});const e=t*Math.round(this.current/this.third);this.children.forEach(e=>e.resize(t)),this.max=-Math.abs((this.data.length-3)*t),this.min=-Math.abs(3*t),s.setStyles(this.element,{width:this.data.length*t+"px",transform:`translateX(${e}px)`}),this.third=t,this.current=e,setTimeout(function(){s.setStyles(this.element,{transition:`transform ${this.transition}ms ease 0s`})}.bind(this),this.transition/10)}}class l{constructor(t,e=null,i){this.third=i||Math.floor(t.clientWidth/3),this.transition=600,this.element=t,this.data=e,this.nav={prev:new n("⬅️","prev",this,!0),next:new n("➡️","next",this),play:new n("▶️","play",this),stop:new n("⏹️","stop",this)},this.track=new a(this.third,this,this.transition),this.autoScroll=null}init(){this.element.appendChild(this.track.element),this.initKeyboardListener(),this.initData(),s.setStyles(this.element,{height:this.third+"px",overflow:"hidden",position:"relative"}),window.addEventListener("resize",function(){const t=Math.floor(this.element.clientWidth/3);this.third=t,s.setStyles(this.element,{height:t+"px"}),this.track.resize(t)}.bind(this),!1),this.element.addEventListener("focus",function(){s.setStyles(this.element,{outline:"none"})}.bind(this));for(const t in this.nav)this.nav[t].render()}initKeyboardListener(){s.setAttributes(this.element,{tabindex:0}),this.element.addEventListener("keyup",t=>{t.isComposing||229===t.keyCode||(37===t.keyCode&&this.nav.prev.element.click(),39===t.keyCode&&this.nav.next.element.click())})}initData(){this.data||(this.data=this.element.dataset.source),fetch(this.data).then(t=>t.json()).then(t=>{this.track.addData(t.productData)})}disableNav(){this.nav.prev.setDisabled(!0),this.nav.next.setDisabled(!0)}enableNav(){this.nav.prev.setDisabled(!1),this.nav.next.setDisabled(!1)}sendDirection(t){this.track.scroll(t)}play(){this.nav.next.element.click(),this.nav.play.hide(),this.nav.stop.show(),this.autoScroll=setInterval(function(){this.nav.next.element.click()}.bind(this),6*this.transition)}stop(){this.nav.play.show(),this.nav.stop.hide(),clearInterval(this.autoScroll)}}const h=document.createElement("template");h.innerHTML="\n  <style>\n    div {\n      font-family: Arial, Helvetica, sans-serif;\n      color: darkgrey;\n    }\n  </style>\n  <div></div>\n";class o extends HTMLElement{static get observedAttributes(){return["source"]}constructor(){super();const t=this.attachShadow({mode:"closed"});t.appendChild(h.content.cloneNode(!0)),this.element=t.querySelector("div");const e=this.element.clientWidth/3;new l(this.element,this.source,e).init()}get source(){return this.getAttribute("source")}}window.customElements.define("carousel-comp",o)}]);